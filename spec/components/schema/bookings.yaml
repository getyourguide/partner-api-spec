openapi: 3.0.2
info:
  title: bookings
  version: 1.0.0
paths: {}
components:
  schemas:
    BookingCreateActivity:
      type: object
      properties:
        base_data:
          type: object
          properties:
            cnt_language:
              description: ISO 639, Language of the text content.
              type: string
              example: "en"
            currency:
              description: ISO 4217, The currency with which you would like to pay.
              type: string
              example: "EUR"
        data:
          type: object
          properties:
            booking:
              type: object
              properties:
                coupon:
                  type: object
                  properties:
                    coupon_code:
                      type: string
                      example: 123ABC
                bookable:
                  type: object
                  properties:
                    option_id:
                      $ref: '../commons.yaml#/components/schemas/OptionId'
                    datetime:
                      $ref: '../commons.yaml#/components/schemas/Datetime'
                    price:
                      type: string
                      example: '170.00'
                    categories:
                      type: array
                      items:
                        type: object
                        properties:
                          category_id:
                            type: string
                            example: '2077534'
                          number_of_participants:
                            type: string
                            example: '5'
                    booking_parameters:
                      $ref: '../schema/bookings.yaml#/components/schemas/BookingParameters'

    BookingCreateCoupon:
      type: object
      properties:
        base_data:
          type: object
          properties:
            cnt_language:
              description: ISO 639, Language of the text content.
              type: string
              example: "en"
            currency:
              description: ISO 4217, The currency with which you would like to pay.
              type: string
              example: "EUR"
        data:
          type: object
          properties:
            booking:
              type: object
              properties:
                coupon:
                  type: object
                  properties:
                    coupon_code:
                      type: string
                      example: 123ABC

    BookingCreateResponse:
      type: object
      properties:
        bookings:
          type: object
          properties:
            shopping_cart_id:
              $ref: '../commons.yaml#/components/schemas/ShoppingCartId'
            shopping_cart_hash:
              $ref: '../commons.yaml#/components/schemas/ShoppingCartHash'
            booking_id:
              $ref: '../commons.yaml#/components/schemas/BookingId'
            booking_hash:
              $ref: '../commons.yaml#/components/schemas/BookingHash'
            status:
              $ref: '../commons.yaml#/components/schemas/BookingStatus'
            return_code:
              $ref: '../commons.yaml#/components/schemas/ReturnCode'

    BookingsGetByHashResponse:
      type: object
      properties:
        booking:
          $ref: '#/components/schemas/Booking'

    BookingDeleteResponse:
      type: object
      properties:
        bookings:
          type: object
          properties:
            shopping_cart_id:
              $ref: '../commons.yaml#/components/schemas/ShoppingCartId'
            shopping_cart_hash:
              $ref: '../commons.yaml#/components/schemas/ShoppingCartHash'
            booking_id:
              $ref: '../commons.yaml#/components/schemas/BookingId'
            booking_hash:
              $ref: '../commons.yaml#/components/schemas/BookingHash'
            booking_status:
              $ref: '../commons.yaml#/components/schemas/BookingStatus'
            return_code:
              $ref: '../commons.yaml#/components/schemas/ReturnCode'
    
    Booking:
      type: object
      properties:
        booking_id:
          $ref: '../commons.yaml#/components/schemas/BookingId'
        booking_hash:
          $ref: '../commons.yaml#/components/schemas/BookingHash'
        booking_status:
          $ref: '../commons.yaml#/components/schemas/BookingStatus'
        shopping_cart_id:
          $ref: '../commons.yaml#/components/schemas/ShoppingCartId'
        shopping_cart_hash:
          $ref: '../commons.yaml#/components/schemas/ShoppingCartHash'
        bookable:
          description: Only present if the booking is confirmed and active.
          $ref: '#/components/schemas/Bookable'
        ticket:
          $ref: '#/components/schemas/Ticket'
      required:
        - booking_id
        - booking_hash
        - booking_status
        - shopping_cart_id
        - shopping_cart_hash
        - bookable

    Bookable:
      type: object
      properties:
        tour_id:
          $ref: '../commons.yaml#/components/schemas/TourId'
        option_id:
          $ref: '../commons.yaml#/components/schemas/OptionId'
        datetime:
          $ref: '../commons.yaml#/components/schemas/Datetime'
        datetime_utc:
          $ref: '../commons.yaml#/components/schemas/DatetimeUTC'
        datetime_type:
          $ref: '../commons.yaml#/components/schemas/DatetimeType'
        opening_hours:
          type: array
          items:
            type: object
            properties:
              opening_time:
                $ref: '../commons.yaml#/components/schemas/Datetime'
              closing_time:
                $ref: '../commons.yaml#/components/schemas/Datetime'
        price:
          description: The price of the activity described in this bookable. You will have to calculate reduced prices yourself. The discount as a percentage value, if present, is retrieved from the options/availabilities endpoint.
          type: number
          format: double
          example: 270
        valid_until:
          $ref: '../commons.yaml#/components/schemas/Datetime'
        cancellation_policy_text:
          $ref: '../commons.yaml#/components/schemas/CancellationPolicyText'
        currently_cancellable_at_no_fee:
          $ref: '../commons.yaml#/components/schemas/CurrentlyCancellableAtNoFee'
        categories:
          type: array
          description: The price categories used for this booking.
          items:
            type: object
            properties:
              category_id:
                type: number
                example: 302628
              name:
                type: string
                example: Adults
              number_of_participants: 
                type: number
                example: 1
        booking_parameters:
          $ref: '#/components/schemas/BookingParameters'

    BookingParameters:
      type: array
      items:
        type: object
        properties:
          name:
            type: string
            description: Name of the property
            enum: [language, hotel, comment, supplier_requested_question]
            example: language
          value_1:
            type: string
            description: First / Primary value of the property
            example: language_live
          value_2:
            type: string
            description: The language property requires a second value (e.g. value_1 = language_live, value_2 = en).
            example: en
          mandatory:
            type: boolean
            description: The mandatory booking parameters can be retrieved from the options endpoint
            example: false

    Ticket:
      type: object
      properties:
        booking_reference:
          type: string
          example: GYG7VMWR9HZ3
        supplier_booking_codes:
          $ref: "#/components/schemas/SupplierBookingCodes"
        emergency_phone_number:
          type: string
          example: '+49 30 56839111'
        emergency_email:
          type: string
          format: email
          example: example@getyourguide.com
        ticket_url:
          type: string
          format: uri
          description: Download link for ticket PDF
          example: https://www.getyourguide.com/voucher/7H8N87D3QAH16XVABGPCR311U66XELRG
        ticket_hash:
          type: string
          example: 7H8N87D3QAH16XVABGPCR311U66XELRG
    
    SupplierBookingCodes:
      type: array
      items:
        type: object
        properties:
          ticket_hash:
            type: string
            example: 7H8N87D3QAH16XVABGPCR311U66XELRG
          label:
            type: string
            example: 'Ticket #1 (ADULT)'
          type:
            type: string
            example: qr_code
          code:
            type: string
            example: JRUFX567YOMTSI7RG5K3UL2XC6RECSGQ-E9VNO
          pricing_category_id:
            type: number
            example: 2167696
